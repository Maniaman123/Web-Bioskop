<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Daftar Film - Bioskop</title>
    <link rel="stylesheet" href="style.css" />
</head>
<body>
    <header>
        <div class="container">
            <h1>Bioskop - Daftar Film</h1>
        </div>
    </header>
    <main>
        <section id="movies" class="movies-section">
            <div class="container">
                <h2 id="cinemaTitle">Daftar Film</h2>
                <p id="cinemaLocation"></p>
                <div id="moviesGrid" class="movies-grid">
                    <!-- Film akan di-generate via JavaScript -->
                </div>
                <button id="backToCinemas" class="back-btn">Kembali ke Pilih Bioskop</button>
            </div>
        </section>
    </main>
    <footer>
        <div class="container">
            <p>&copy; 2025 Bioskop. All rights reserved.</p>
        </div>
    </footer>
    <script>
        const cinemas = [
            { id: 0, name: 'Bioskop Grand Mall', location: 'Jakarta Pusat' },
            { id: 1, name: 'Cinema XXI Plaza', location: 'Jakarta Selatan' },
            { id: 2, name: 'CGV Mall', location: 'Jakarta Barat' }
        ];

        const films = [
            { id: 0, name: 'Avengers: Endgame', genre: 'action', poster: 'Avanger.png', duration: '180 menit', cinemas: [0, 1] },
            { id: 1, name: 'Titanic', genre: 'drama', poster: 'Titanic.png', duration: '195 menit', cinemas: [1, 2] },
            { id: 2, name: 'Deadpool', genre: 'comedy', poster: 'Deadpool.png', duration: '108 menit', cinemas: [0, 2] },
            { id: 3, name: 'Waktu Maghrib', genre: 'horror', poster: 'Waktu.png', duration: '135 menit', cinemas: [0, 1, 2] }
        ];

        function getQueryParam(param) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(param);
        }

        function generateFilms(cinemaId) {
            const cinema = cinemas.find(c => c.id === cinemaId);
            if (!cinema) {
                alert('Bioskop tidak ditemukan');
                window.location.href = 'pilih-film.html';
                return;
            }

            document.getElementById('cinemaTitle').textContent = `Daftar Film - ${cinema.name}`;
            document.getElementById('cinemaLocation').textContent = `Lokasi: ${cinema.location}`;

            const grid = document.getElementById('moviesGrid');
            grid.innerHTML = '';

            const availableFilms = films.filter(film => film.cinemas.includes(cinemaId));

            if (availableFilms.length === 0) {
                grid.innerHTML = '<p style="text-align:center; color:#ccc;">Tidak ada film yang tersedia di bioskop ini.</p>';
                return;
            }

            availableFilms.forEach(film => {
                const card = document.createElement('div');
                card.className = 'movie-card';
                card.innerHTML = `
                    <img src="${film.poster}" alt="${film.name}" onerror="this.src='https://via.placeholder.com/200x300/FF0000/FFFFFF?text=No+Image'">
                    <h4>${film.name}</h4>
                    <p>Genre: ${film.genre.charAt(0).toUpperCase() + film.genre.slice(1)} | Durasi: ${film.duration}</p>
                    <button onclick="window.location.href='kursi.html?cinemaId=${cinemaId}&filmId=${film.id}'" class="select-movie">Pilih Film</button>
                `;
                grid.appendChild(card);
            });
        }

        document.addEventListener('DOMContentLoaded', function() {
            const cinemaId = parseInt(getQueryParam('cinemaId'));
            if (isNaN(cinemaId) || cinemaId < 0 || cinemaId > 2) {
                alert('Parameter bioskop tidak valid');
                window.location.href = 'pilih-film.html';
                return;
            }
            generateFilms(cinemaId);
        });

        document.getElementById('backToCinemas').addEventListener('click', function() {
            window.location.href = 'pilih-film.html';
        });
    </script>
    <script>
        document.getElementById('backToCinemas').addEventListener('click', function() {
            window.location.href = 'pilih-film.html';
        });
    </script>
</body>
</html>
